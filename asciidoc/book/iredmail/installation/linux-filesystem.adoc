=== Filesystem

I'd choose XFS as the filesystem for email storage.
See http://xfs.org/index.php/XFS_FAQ[XFS FAQ].

[source,bash,linenums]
.Install XFS
----
apt-get install -y xfsprogs
----

[source,bash,linenums]
.Setup new XFS filesystem
----
mkfs.xfs /dev/vda3
----

[source,bash,linenums]
.Example
----
meta-data=/dev/vda3              isize=256    agcount=4, agsize=19791934 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=0        finobt=0
data     =                       bsize=4096   blocks=79167736, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=0
log      =internal log           bsize=4096   blocks=38656, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
----

[source,bash,linenums]
.Find UUID for new XFS filesystem
----
root@mx:~# ls -la /dev/disk/by-uuid/
total 0
drwxr-xr-x 2 root root 100 Mar 17 19:17 .
drwxr-xr-x 4 root root  80 Mar 17 19:17 ..
lrwxrwxrwx 1 root root  10 Mar 17 19:17 13859621-3f11-40d8-9e2b-0336703e3ca1 -> ../../vda3
lrwxrwxrwx 1 root root  10 Mar 17 19:17 961a1e6b-5875-491a-a25b-522da9abc841 -> ../../vda2
lrwxrwxrwx 1 root root  10 Mar 17 19:17 afb7272d-6c75-4f4c-adca-7f755b913a0c -> ../../vda1

root@mx:~# blkid
/dev/vda1: UUID="afb7272d-6c75-4f4c-adca-7f755b913a0c" TYPE="ext4" PARTUUID="83db053a-01"
/dev/vda2: UUID="961a1e6b-5875-491a-a25b-522da9abc841" TYPE="swap" PARTUUID="83db053a-02"
/dev/vda3: UUID="13859621-3f11-40d8-9e2b-0336703e3ca1" TYPE="xfs" PARTUUID="83db053a-03"
----

==== Move /var to new filesystem

[source,bash,linenums]
.Add new filesystem to /etc/fstab
----
cat >>/etc/fstab <EOF
UUID=13859621-3f11-40d8-9e2b-0336703e3ca1  /var  xfs  defaults,inode64  0  0
EOF
----

[source,bash,linenums]
.Move var to new filesystem
----
mv var var_old ; mkdir /var ; mount -o defaults,inode64 /dev/vda3 /var ; rm -rf /var_old
----

=== Swap

Add some swap space if needed.

TIP: See https://wiki.debian.org/Swap[Debian Wiki: Swap] for more information.

[source,bash,linenums]
.Prepare file with 32 GB
----
mkdir /var/swap
dd if=/dev/zero of=/var/swap/swap0 bs=1M count=$((32 * 1000))
----

[source,bash,linenums]
.Setup new swap space
----
chmod 600 /var/swap/swap0
mkswap /var/swap/swap0
swapon /var/swap/swap0
----

and don't forget to add it to `/etc/fstab`:

[source,bash,linenums]
----
cat >>/etc/fstab <<EOF
/var/swap/swap0       none    swap    sw      0       0
EOF
----

[source,bash,linenums]
.View new swap space
----
root@mx:~# free -h
             total       used       free     shared    buffers     cached
Mem:           23G        23G       186M        19M        17M        21G
-/+ buffers/cache:       2.0G        21G
Swap:          31G         0B        31G
----
